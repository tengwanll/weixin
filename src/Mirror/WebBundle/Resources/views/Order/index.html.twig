{% extends 'MirrorWebBundle:Base:base.html.twig' %}
{% block title %}订单列表{% endblock %}
{% block css %}
    <link rel="stylesheet" href="{{ asset('/bundles/mirrorweb/css/orderList.css') }}">
{% endblock %}
{% block body %}
    <div id="container">
        <div class="goodsListFilter">
            <span class="orderStatus" status="2">待完成</span><span class="orderStatus" status="3">已完成</span>
        </div>
        <div class="goodsListCon">
            <ul>

            </ul>
        </div>
    </div>
{% endblock %}
{% block script %}
    <script>
        getList(3);
        $('.orderStatus').click(function(){
            var status=$(this).attr('status');
            getList(status);
        });
        function getList(status){
            ajaxAction("get",'/api/user/order?status='+status,'',false,function(data,textStatus){
                var dataList = data.list;
                var orderListHtml = '';
                $.each(dataList,function (idx,obj) {
                    var report='';
                    if(obj.report){
                        report='<a href="'+obj.report+'">下载报表</a>';
                    }
                    orderListHtml += ' <li><span><img src="'+obj.logo+'" alt=""></span><div class="priceTitle"><p>'+obj.name+'</p><span class="downOrderTime">'+formatter(obj.payTime*1000,'YYYY MM DD')+'</span><span class="productNum">数量：'+obj.number+'</span><span class="orderPrice">￥'+obj.price+'</span>'+report+'</div></li>';
                });
                $('.goodsListCon ul').html(orderListHtml);
            },function(errno,errmsg){
                console.log(errmsg);
            });
        }
    </script>
{% endblock  %}